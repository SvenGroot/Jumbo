<?xml version="1.0" encoding="utf-8"?>
<project name="Jumbo" default="all" xmlns="http://nant.sf.net/release/0.86-beta1/nant.xsd">
  <target name="all" depends="NameServer,DataServer,DfsShell,ClientSample,JobServer,TaskServer,TaskHost,Ookii.Jumbo.Test,JetShell,DfsWeb,JetWeb,Ookii.Jumbo.Jet.Samples">
    <copy todir="nantbin">
      <fileset>
        <include name="jumbo-config.sh"/>
        <include name="run-server.sh"/>
        <include name="run-dfs.sh"/>
        <include name="run-jet.sh"/>
        <include name="nunit.sh"/>
      </fileset>
    </copy>
    <exec program="gen-scripts.sh" />
  </target>
  <target name="clean">
    <delete dir="nantbin" failonerror="false"/>
  </target>
  <target name="cleanall" depends="clean">
    <nant buildfile="Ookii.Jumbo.Dfs/Ookii.Jumbo.Dfs.build" target="clean"/>
    <nant buildfile="NameServer/NameServer.build" target="clean"/>
    <nant buildfile="DataServer/DataServer.build" target="clean"/>
    <nant buildfile="DfsShell/DfsShell.build" target="clean"/>
    <nant buildfile="Ookii.Jumbo.Test/Ookii.Jumbo.Test.build" target="clean"/>
    <nant buildfile="Ookii.Jumbo.Test.Tasks/Ookii.Jumbo.Test.Tasks.build" target="clean"/>
    <nant buildfile="Ookii.Jumbo/Ookii.Jumbo.build" target="clean"/>
    <nant buildfile="Ookii.Jumbo.Jet/Ookii.Jumbo.Jet.build" target="clean"/>
    <nant buildfile="ClientSample/ClientSample.build" target="clean"/>
    <nant buildfile="JobServer/JobServer.build" target="clean"/>
    <nant buildfile="TaskServer/TaskServer.build" target="clean"/>
    <nant buildfile="TaskHost/TaskHost.build" target="clean"/>
    <nant buildfile="JetShell/JetShell.build" target="clean"/>
    <nant buildfile="Ookii.Jumbo.Native/Ookii.Jumbo.Native.build" target="clean" />
  </target>
  <target name="Version.cs">
    <exec program="gen-version.sh"/>
  </target>
  <target name="Ookii.Jumbo.Native">
    <mkdir dir="nantbin"/>
    <nant buildfile="Ookii.Jumbo.Native/Ookii.Jumbo.Native.build"/>
    <copy todir="nantbin">
      <fileset basedir="Ookii.Jumbo.Native/nantbin">
        <include name="*.*" />
      </fileset>
    </copy>
  </target>
  <target name="Ookii.Jumbo" depends="Ookii.Jumbo.Native,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="Ookii.Jumbo/Ookii.Jumbo.build" />
    <copy todir="nantbin">
      <fileset basedir="Ookii.Jumbo/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="Ookii.Jumbo.Dfs" depends="Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="Ookii.Jumbo.Dfs/Ookii.Jumbo.Dfs.build" />
    <copy todir="nantbin">
      <fileset basedir="Ookii.Jumbo.Dfs/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="Ookii.Jumbo.Jet" depends="Ookii.Jumbo,Ookii.Jumbo.Dfs,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="Ookii.Jumbo.Jet/Ookii.Jumbo.Jet.build" />
    <copy todir="nantbin">
      <fileset basedir="Ookii.Jumbo.Jet/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="Ookii.Jumbo.Jet.Samples" depends="Ookii.Jumbo,Ookii.Jumbo.Dfs,Ookii.Jumbo.Jet,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="Ookii.Jumbo.Jet.Samples/Ookii.Jumbo.Jet.Samples.build" />
    <copy todir="nantbin">
      <fileset basedir="Ookii.Jumbo.Jet.Samples/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="NameServer" depends="Ookii.Jumbo.Dfs,Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="NameServer/NameServer.build" />
    <copy todir="nantbin">
      <fileset basedir="NameServer/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="DataServer" depends="Ookii.Jumbo.Dfs,Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="DataServer/DataServer.build" />
    <copy todir="nantbin">
      <fileset basedir="DataServer/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="DfsShell" depends="Ookii.Jumbo.Dfs,Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="DfsShell/DfsShell.build" />
    <copy todir="nantbin">
      <fileset basedir="DfsShell/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="ClientSample" depends="Ookii.Jumbo.Dfs,Ookii.Jumbo.Jet,Ookii.Jumbo.Jet.Samples,Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="ClientSample/ClientSample.build" />
    <copy todir="nantbin">
      <fileset basedir="ClientSample/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="JobServer" depends="Ookii.Jumbo.Dfs,Ookii.Jumbo.Jet,Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="JobServer/JobServer.build" />
    <copy todir="nantbin">
      <fileset basedir="JobServer/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="TaskServer" depends="Ookii.Jumbo.Dfs,Ookii.Jumbo.Jet,Ookii.Jumbo,TaskHost,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="TaskServer/TaskServer.build" />
    <copy todir="nantbin">
      <fileset basedir="TaskServer/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="TaskHost" depends="Ookii.Jumbo.Dfs,Ookii.Jumbo.Jet,Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="TaskHost/TaskHost.build" />
    <copy todir="nantbin">
      <fileset basedir="TaskHost/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="JetShell" depends="Ookii.Jumbo.Jet,Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="JetShell/JetShell.build" />
    <copy todir="nantbin">
      <fileset basedir="JetShell/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>  
  <target name="Ookii.Jumbo.Test.Tasks" depends="Ookii.Jumbo.Jet,Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="Ookii.Jumbo.Test.Tasks/Ookii.Jumbo.Test.Tasks.build" />
    <copy todir="nantbin">
      <fileset basedir="Ookii.Jumbo.Test.Tasks/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="Ookii.Jumbo.Test" depends="Ookii.Jumbo,Ookii.Jumbo.Dfs,Ookii.Jumbo.Jet,NameServer,DataServer,JobServer,TaskServer,TaskHost,Ookii.Jumbo.Test.Tasks,Version.cs">
    <mkdir dir="nantbin"/>
    <nant buildfile="Ookii.Jumbo.Test/Ookii.Jumbo.Test.build" />
    <copy todir="nantbin">
      <fileset basedir="Ookii.Jumbo.Test/nantbin">
        <include name="*.*"/>
      </fileset>
    </copy>
  </target>
  <target name="DfsWeb" depends="Ookii.Jumbo.Dfs,Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin/DfsWeb"/>
    <nant buildfile="DfsWeb/DfsWeb.build" />
    <copy todir="nantbin/DfsWeb">
      <fileset basedir="DfsWeb">
        <include name="**"/>
      </fileset>
    </copy>
  </target>
  <target name="JetWeb" depends="Ookii.Jumbo.Jet,Ookii.Jumbo,Version.cs">
    <mkdir dir="nantbin/JetWeb"/>
    <nant buildfile="JetWeb/JetWeb.build" />
    <copy todir="nantbin/JetWeb">
      <fileset basedir="JetWeb">
        <include name="**"/>
      </fileset>
    </copy>
  </target>
</project>